{"version":3,"sources":["assets\\共用模塊\\Model.js"],"names":["TopTitle","Prize_BackGround","WhitchPrize_index","XMLTimeLimit","gametimelimit","gametimeCountDown","round","Domain","GameStatusMessage","result","prize_total","role","winner_name","winner_id","winner_picture","winner_score","winner_TakeTime","WinnerData","AlreadyPlayed","people","activity_id","game_id","liffstate","User_id","User_Name","User_Picture","prize_ID","Win_Time","prize_name_guest","prize_name_host","prize_method","getprize_round","password","prize_picture","prize_type","exchangePrize","GameStatusWS_Host","NumberOfLotteryWS_Host","NumberOfPeople_Guest","Session","CannotJoinGame","AllowRePrize","CheckRole","connet_ws","Guest1_Join_JS","GameName","SpawnNewestWinner","session_id","CurrentRound","HostWindow","Score","Skin","Local_ID","BackGround_Theme","AnswerResult","Question","QuestionCount","Options","QuestionPicture","Answer","Rank","mode","chance","Prizestack_id","Prizestack_name","Prizestack_picture","Game_js","game_type","PrizeStaffs","module","exports","Game_Information","RoleComfirm","Lottery_Guest","WebSocket_NumberOfPeople_Guest","WebSocket_NumberOfPeople_Host","WebSocket_GameStatus_Guest","WebSocket_GameStatus_Host","WebSocket_UpDateScore_Guest","WebSocket_NumberOfLottery_Host","WebSocket_NumberOfLottery_Score_Host","Prize_Infromation","url","gameModel","local_ID","redpack","XMLHttpRequest","open","onreadystatechange","readyState","status","text","responseText","XMLobject","JSON","parse","data","title","allow","limit_time","second","send","Role","User","user_id","name","avatar","Game","amount","Times","i","length","id","prize_name","method","win_time","picture","message","Prize","prize_id","SpawnPrize","Lottery","PrizeStaff","lettorey","time","sendmessage","WebSocket","onopen","event","onerror","onclose","setTimeout","OPEN","stringify","ConnetFail","ConnetSuccess","onmessage","require","object","error","ws","clearInterval","Interval","setInterval","score","includes","SpawnNewWinner","NewestWinner","close","ClearRank","NextSence","getQueryVariable","variable","query","window","location","search","substring","vars","split","pair","HandleLiffState","substr","params","readCookie","nameEQ","ca","document","cookie","c","charAt","indexOf"],"mappings":"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","sourceRoot":"/","sourcesContent":["///共用模塊js\r\nvar TopTitle = null\r\nvar Prize_BackGround = null\r\nvar WhitchPrize_index = 0;\r\nvar XMLTimeLimit = false;\r\nvar gametimelimit = 5;\r\nvar gametimeCountDown = 0\r\nvar round = 1;\r\nvar Domain = null;\r\nvar GameStatusMessage = \"close\";\r\nvar result = \"thanks\"; \r\nvar prize_total = 0;\r\nvar role = null;\r\nvar winner_name = [];\r\nvar winner_id = [];\r\nvar winner_picture = [];\r\nvar winner_score =[];\r\nvar winner_TakeTime = 0\r\nvar WinnerData = null;\r\nvar AlreadyPlayed = 0; \r\nvar people = 0;\r\nvar activity_id = null;\r\nvar game_id = null;\r\nvar liffstate = null;\r\nvar User_id = null;\r\nvar User_Name = null;\r\nvar User_Picture = null;\r\nvar prize_ID = [];\r\nvar Win_Time = [];\r\nvar prize_name_guest = []; \r\nvar prize_name_host = [];\r\nvar prize_method = [];\r\nvar getprize_round = []\r\nvar password = [];\r\nvar prize_picture = [];\r\nvar prize_type = \"\";\r\nvar exchangePrize =[];\r\nvar GameStatusWS_Host = null\r\nvar NumberOfLotteryWS_Host = null\r\nvar NumberOfPeople_Guest = null;\r\nvar Session = null; \r\nvar CannotJoinGame = \"\";\r\nvar AllowRePrize =\"\";\r\nvar CheckRole = false;\r\nvar connet_ws = false;\r\nvar Guest1_Join_JS =\"\";\r\nvar GameName = \"\"\r\nvar SpawnNewestWinner = false;\r\nvar session_id = \"\"\r\nvar CurrentRound = 0;\r\nvar HostWindow = \"open\";\r\nvar Score = 0;\r\nvar Skin = \"\";\r\nvar Local_ID = \"\";\r\nvar BackGround_Theme =\"\";\r\nvar AnswerResult = [];\r\nvar Question = [];\r\nvar QuestionCount = 0;\r\nvar Options = [];\r\nvar QuestionPicture = [];\r\nvar Answer = 0\r\nvar Rank = 0;\r\nvar mode = \"\";\r\nvar chance = 0;\r\nvar Prizestack_id = [];\r\nvar Prizestack_name = [];\r\nvar Prizestack_picture = []; \r\nvar Game_js = \"\";\r\nvar game_type = \"\";\r\nvar PrizeStaffs = \"\";\r\n\r\n\r\n//要在自己的腳本導出變量才能讓別人繼承  \r\nmodule.exports = {    \r\n    TopTitle, //遊戲的上方框\r\n    Prize_BackGround, //玩家查看獎品場景的背景\r\n    WhitchPrize_index, //兌換畫面當前選的獎品編號\r\n    XMLTimeLimit, //遊戲是否限時\r\n    gametimelimit, //遊戲限制的時間\r\n    gametimeCountDown, //遊戲倒數計時\r\n    round, //輪次\r\n    Domain, //當前網域\r\n    GameStatusMessage, //遊戲狀態 : open、start、end\r\n    result, //中獎結果 thanks代表沒中獎，其他代表中獎\r\n    prize_total, //獎品數量\r\n    role, //用戶角色(主持人OR玩家)\r\n    Game_Information, //取得遊戲設置資訊XML\r\n    RoleComfirm, //接收角色判斷和輪次XML\r\n    Lottery_Guest, //玩家中獎判斷XML\r\n    winner_name, //主持人紀錄得獎玩家名子\r\n    winner_picture, //主持人紀錄得獎玩家頭像\r\n    winner_id, //主持人紀錄得獎玩家辨識碼\r\n    winner_score, //主持人紀錄得獎玩家分數\r\n    WinnerData, //主持人 Host3_ShowNewWinner js腳本\r\n    WebSocket_NumberOfPeople_Guest,//新增人員(玩家用)\r\n    WebSocket_NumberOfPeople_Host,//新增人員(主持人用)\r\n    WebSocket_GameStatus_Guest,//遊戲狀態的訊息傳送(玩家用)\r\n    WebSocket_GameStatus_Host,//遊戲狀態的訊息傳送(主持人用)\r\n    WebSocket_UpDateScore_Guest,//玩家每秒將分數傳給後端(玩家用)\r\n    WebSocket_NumberOfLottery_Host,//主持人收到搖紅包到一定次數的玩家訊息(主持人用)\r\n    WebSocket_NumberOfLottery_Score_Host, //主持人收到玩家分數(主持人用)\r\n    AlreadyPlayed, //該輪是否玩過\r\n    people, //人數\r\n    activity_id, //活動辨識碼\r\n    game_id, //遊戲辨識碼\r\n    liffstate,\r\n    User_id, //用戶辨識碼(回傳後端用)\r\n    User_Name, //用戶名稱(回傳後端用)\r\n    User_Picture, //用戶頭像(回傳後端用)\r\n    prize_ID, //獎品辨識碼\r\n    Win_Time, //得獎時間\r\n    prize_name_guest, //獎品名稱(玩家兌獎畫面顯示)\r\n    prize_name_host, //獎品名稱(主持人結算場景顯示)\r\n    prize_method, //獎品兌換方式\r\n    password, //獎品密碼\r\n    prize_picture, //獎品圖片\r\n    getprize_round, //取得得獎的輪次\r\n    exchangePrize, //獎品是否兌換過\r\n    GameStatusWS_Host, //開啟主持人遊戲狀態的ws\r\n    NumberOfLotteryWS_Host, //開啟主持人接收中獎人的ws \r\n    NumberOfPeople_Guest, //開啟玩家加入遊戲執行的ws\r\n    Session, //場次\r\n    CannotJoinGame, //不能參加遊戲的錯誤訊息\r\n    AllowRePrize, //可以重複中獎\r\n    CheckRole, //是否檢查完角色\r\n    connet_ws, //是否有連接到websocket\r\n    Guest1_Join_JS, //玩家 Guest1_Join js腳本\r\n    GameName, //遊戲名稱\r\n    SpawnNewestWinner, //是否有顯示最新兩位得獎人\r\n    session_id, //用戶cookie值\r\n    CurrentRound, //當前輪次(用於主持人結算頁面使用，因為開始遊戲會清空人數，輪次 + 1)\r\n    HostWindow, //主持人在遊戲中是否關閉視窗\r\n    Score, //玩家分數\r\n    Skin, //用戶選擇的角色皮膚\r\n    Local_ID,\r\n    BackGround_Theme, //用戶選擇的主題背景\r\n    ///--------------------------------------------------------------問答遊戲參數\r\n    //=====主持人=====\r\n    AnswerResult, // 問答遊戲 每個選項的人數\r\n    Question, //問答遊戲 存放問題陣列\r\n    QuestionCount, //問答遊戲 計數目前是哪個問題\r\n    Options, //問答遊戲 問題選項文字陣列\r\n    QuestionPicture, //問答遊戲 主持人遊戲時用得問題圖片陣列\r\n    Answer, //問答遊戲 本輪問題的答案\r\n    //=====玩家=====\r\n    Rank, //問答問題 玩家排名\r\n    winner_TakeTime, //問答遊戲 玩家耗時\r\n    ///--------------------------------------------------------------幸運輪盤參數\r\n    mode,  //目前模式\r\n    chance, //目前抽獎次數\r\n    Prize_Infromation,\r\n    prize_type,\r\n    Prizestack_id,\r\n    Prizestack_name,\r\n    Prizestack_picture,\r\n    Game_js,\r\n    game_type,\r\n    PrizeStaffs,\r\n};\r\n\r\n//取得遊戲設置資訊\r\nfunction Game_Information(){ \r\n    var url = 'https://'+ gameModel.local_ID +'/v1/interact/game/' + gameModel.GameName + '?game_id=' + gameModel.game_id;\r\n    var redpack = new XMLHttpRequest(); \r\n    redpack.open(\"GET\", url, true);\r\n    redpack.onreadystatechange = function () {\r\n        if (redpack.readyState == 4 && (redpack.status >= 200 && redpack.status <= 207)) { //是否連接成功\r\n            var text = redpack.responseText\r\n            var XMLobject = JSON.parse(redpack.responseText);\r\n            gameModel.Session = XMLobject.data.title;\r\n            gameModel.AllowRePrize = XMLobject.data.allow;\r\n            gameModel.game_type = XMLobject.data.game_type\r\n            //是否有限制遊戲時間\r\n            if(XMLobject.data.limit_time == \"open\")\r\n            {\r\n                gameModel.XMLTimeLimit = true;\r\n                gameModel.gametimelimit = XMLobject.data.second;\r\n            }\r\n            else gameModel.XMLTimeLimit = false;\r\n        } \r\n    };\r\n    redpack.send();\r\n}\r\n\r\n//接收角色判斷和輪次XML\r\nfunction RoleComfirm(){\r\n    var url = 'https://'+ gameModel.local_ID +'/v1/user?activity_id=' + gameModel.activity_id + '&game_id='+ gameModel.game_id + '&game='+ gameModel.GameName + '&session_id='+ gameModel.session_id;                \r\n    var Role = new XMLHttpRequest();\r\n    Role.open(\"GET\", url, true); //GET取得、POST傳送、PUT更改\r\n    Role.onreadystatechange = function () {\r\n        if (Role.readyState == 4 && (Role.status >= 200 && Role.status <= 207)) { //是否連接成功\r\n            var XMLobject = JSON.parse(Role.responseText);\r\n            //開始接收訊息\r\n            gameModel.role = XMLobject.data.User.role\r\n            gameModel.User_id = XMLobject.data.User.user_id;\r\n            gameModel.User_Name = XMLobject.data.User.name;\r\n            gameModel.User_Picture = XMLobject.data.User.avatar;\r\n            gameModel.round = XMLobject.data.Game.round;\r\n            gameModel.prize_total = XMLobject.data.Game.amount;\r\n            gameModel.chance = XMLobject.data.Times;\r\n            gameModel.PrizeStaffs = XMLobject.data.PrizeStaffs\r\n            for(var i = 0;i < XMLobject.data.PrizeStaffs.length; i++)//取得獎品資訊\r\n            {\r\n              gameModel.prize_ID[i] = XMLobject.data.PrizeStaffs[i].id; //獎品編號\r\n              gameModel.prize_name_guest[i] = XMLobject.data.PrizeStaffs[i].prize_name; //獎品名稱\r\n              gameModel.prize_method[i] = XMLobject.data.PrizeStaffs[i].method; //獎品兌換方式\r\n              gameModel.password[i] = XMLobject.data.PrizeStaffs[i].password; //兌獎密碼\r\n              gameModel.Win_Time[i] = XMLobject.data.PrizeStaffs[i].win_time; //抽到獎品的時間\r\n              gameModel.getprize_round[i] = XMLobject.data.PrizeStaffs[i].round; //抽到獎品的輪次\r\n              gameModel.prize_picture[i] = XMLobject.data.PrizeStaffs[i].picture; //獎品照片\r\n              gameModel.exchangePrize[i] = XMLobject.data.PrizeStaffs[i].status; //是否兌換\r\n            }\r\n            gameModel.CheckRole = true\r\n        }\r\n        else if (Role.readyState == 4 && Role.status >= 400)\r\n        {\r\n            var XMLobject = JSON.parse(Role.responseText);\r\n            gameModel.CheckRole = true\r\n            gameModel.CannotJoinGame = XMLobject.message;\r\n        }\r\n    }\r\n    Role.send();\r\n}\r\n\r\n//查詢所有獎品XML\r\nfunction Prize_Infromation(){\r\n    var url = 'https://'+ gameModel.local_ID +'/v1/interact/game/'+ gameModel.GameName +'/prize?game_id=' + gameModel.game_id;                \r\n    var Prize = new XMLHttpRequest();\r\n    Prize.open(\"GET\", url, true); //GET取得、POST傳送、PUT更改\r\n    Prize.onreadystatechange = function () {\r\n        if (Prize.readyState == 4 && (Prize.status >= 200 && Prize.status <= 207)) { //是否連接成功\r\n            var XMLobject = JSON.parse(Prize.responseText);\r\n            //開始接收訊息\r\n            for(var i = 0;i < XMLobject.data.length; i++)\r\n            {\r\n              gameModel.Prizestack_id[i] = XMLobject.data[i].prize_id; //獎品編號\r\n              gameModel.Prizestack_name[i] = XMLobject.data[i].name; //獎品名稱\r\n              gameModel.Prizestack_picture[i] = XMLobject.data[i].picture; //獎品照片\r\n            }\r\n            gameModel.Game_js.SpawnPrize();\r\n        }\r\n        else if (Prize.readyState == 4 && Prize.status >= 400)\r\n        {\r\n            var XMLobject = JSON.parse(Prize.responseText);\r\n            gameModel.CannotJoinGame = XMLobject.message;\r\n        }\r\n    }\r\n    Prize.send();\r\n}\r\n\r\n//玩家中獎判斷XML\r\nfunction Lottery_Guest(){\r\n    var url = 'https://'+ gameModel.local_ID +'/v1/game/lucky?activity_id='+ gameModel.activity_id +'&game_id=' + gameModel.game_id + '&game='+ gameModel.GameName + '&session_id='+ gameModel.session_id + '&mode=' + gameModel.mode;                \r\n    var Lottery = new XMLHttpRequest();\r\n    Lottery.open(\"GET\", url, true); //GET取得、POST傳送、PUT更改\r\n    Lottery.onreadystatechange = function () {\r\n        if (Lottery.readyState == 4 && (Lottery.status >= 200 && Lottery.status <= 207)) { //是否連接成功\r\n            var XMLobject = JSON.parse(Lottery.responseText);\r\n            //開始接收訊息\r\n            gameModel.result = XMLobject.data.PrizeStaff.method;  //抽獎結果 不等於thanks代表中獎，thanks帶表未中獎\r\n            if(gameModel.GameName == \"lottery\")\r\n            {\r\n                gameModel.prize_ID = XMLobject.data.PrizeStaff.prize_id; //獎品編號\r\n                gameModel.prize_name_guest = XMLobject.data.PrizeStaff.prize_name; //獎品名稱\r\n                gameModel.prize_picture = XMLobject.data.PrizeStaff.picture; //獎品照片\r\n                gameModel.prize_type =  XMLobject.data.PrizeStaff.prize_type\r\n                gameModel.PrizeStaffs = XMLobject.data.PrizeStaffs\r\n                gameModel.Game_js.lettorey();\r\n            }\r\n            else\r\n            {\r\n                for(var i = 0;i < XMLobject.data.PrizeStaffs.length; i++)\r\n                {\r\n                  gameModel.prize_ID[i] = XMLobject.data.PrizeStaffs[i].id; //獎品編號\r\n                  gameModel.prize_name_guest[i] = XMLobject.data.PrizeStaffs[i].prize_name; //獎品名稱\r\n                  gameModel.prize_method[i] = XMLobject.data.PrizeStaffs[i].method; //獎品兌換方式\r\n                  gameModel.password[i] = XMLobject.data.PrizeStaffs[i].password; //兌獎密碼\r\n                  gameModel.Win_Time[i] = XMLobject.data.PrizeStaffs[i].win_time; //抽到獎品的時間\r\n                  gameModel.getprize_round[i] = XMLobject.data.PrizeStaffs[i].round; //抽到獎品的輪次\r\n                  gameModel.prize_picture[i] = XMLobject.data.PrizeStaffs[i].picture; //獎品照片\r\n                  gameModel.exchangePrize[i] = XMLobject.data.PrizeStaffs[i].status; //是否兌換\r\n                }\r\n            }\r\n        }\r\n        else if (Lottery.readyState == 4 && Lottery.status >= 400)\r\n        {\r\n            var XMLobject = JSON.parse(Lottery.responseText);\r\n            gameModel.CannotJoinGame = XMLobject.message;\r\n            if(gameModel.GameName == \"lottery\") gameModel.Game_js.lettorey();\r\n        }\r\n    }\r\n    Lottery.send();\r\n}\r\n\r\n//將玩家人數新增到Websocket、接收玩家中獎紀錄\r\nfunction WebSocket_NumberOfPeople_Guest(time,sendmessage){\r\n    if(sendmessage == false)\r\n    {\r\n        gameModel.NumberOfPeople_Guest = new WebSocket(\"wss://\" + gameModel.local_ID + \"/ws/v1/game/staff?activity_id=\"+ gameModel.activity_id + \"&game_id=\"+ gameModel.game_id + \"&game=\"+ gameModel.GameName);\r\n        //連線開啟時觸發 \r\n        gameModel.NumberOfPeople_Guest.onopen = function (event) {\r\n        };\r\n        \r\n        //連線錯誤時\r\n        gameModel.NumberOfPeople_Guest.onerror = function (event) {\r\n        };\r\n        //連線關閉時觸發  \r\n        gameModel.NumberOfPeople_Guest.onclose = function (event) {\r\n            if(gameModel.CannotJoinGame != \"錯誤: 該場次遊戲不允許重複中獎，您已中獎，無法參加下一輪遊戲\") \r\n            {\r\n             gameModel.WebSocket_NumberOfPeople_Guest(1000,false)\r\n            }  \r\n        };\r\n    }\r\n    else\r\n    {\r\n      //等待1秒，等通道打開再執行推送資料給Websocket\r\n      setTimeout(function(){\r\n       if(gameModel.NumberOfPeople_Guest.readyState === WebSocket.OPEN){\r\n            gameModel.NumberOfPeople_Guest.send(JSON.stringify({\r\n                User:{\r\n                    user_id: gameModel.User_id,\r\n                    name: gameModel.User_Name,\r\n                    avatar: gameModel.User_Picture\r\n                },\r\n                Game:{\r\n                    round: (gameModel.GameStatusMessage == \"start\" || gameModel.GameStatusMessage == \"gaming\") ? gameModel.round - 1 : gameModel.round \r\n                }\r\n            }));\r\n      }\r\n      else\r\n      {\r\n        if(gameModel.CannotJoinGame != \"錯誤: 該場次遊戲不允許重複中獎，您已中獎，無法參加下一輪遊戲\") gameModel.Guest1_Join_JS.ConnetFail();\r\n        else gameModel.Guest1_Join_JS.ConnetSuccess();\r\n      }\r\n     },time);\r\n    }\r\n\r\n    //接收到訊息時觸發  \r\n    gameModel.NumberOfPeople_Guest.onmessage = function (event) {\r\n        var gameModel = require(\"Model\");\r\n        var object = JSON.parse(event.data) //將後端資料放入object\r\n        gameModel.CannotJoinGame = object.error;\r\n        gameModel.AlreadyPlayed = object.PrizeStaff.id;  //是否有搖過 0代表還沒玩過 不等於0代表玩過了\r\n        for(var i = 0;i < object.PrizeStaffs.length; i++)\r\n        {\r\n          gameModel.prize_ID[i] = object.PrizeStaffs[i].id; //獎品編號\r\n          gameModel.prize_name_guest[i] = object.PrizeStaffs[i].prize_name; //獎品名稱\r\n          gameModel.prize_method[i] = object.PrizeStaffs[i].method; //獎品兌換方式\r\n          gameModel.password[i] = object.PrizeStaffs[i].password; //兌獎密碼\r\n          gameModel.Win_Time[i] = object.PrizeStaffs[i].win_time; //抽到獎品的時間\r\n          gameModel.getprize_round[i] = object.PrizeStaffs[i].round; //抽到獎品的輪次\r\n          gameModel.prize_picture[i] = object.PrizeStaffs[i].picture; //獎品照片\r\n          gameModel.exchangePrize[i] = object.PrizeStaffs[i].status; //是否兌換\r\n        }\r\n        gameModel.Guest1_Join_JS.ConnetSuccess();\r\n    };\r\n} \r\n\r\n//主持人從Websocket取得現在人數\r\nfunction WebSocket_NumberOfPeople_Host(){\r\n    //取得Websocket通訊網址\r\n    let ws = new WebSocket(\"wss://\" + gameModel.local_ID + \"/ws/v1/game/people?activity_id=\"+ gameModel.activity_id +'&game_id=' + gameModel.game_id + '&game='+ gameModel.GameName)             \r\n    //連線開啟時觸發 \r\n    ws.onopen = function (event) {\r\n    };\r\n    //接收到訊息時觸發  \r\n    ws.onmessage = function (event) {\r\n        var gameModel = require(\"Model\");\r\n        var object = JSON.parse(event.data) //將後端資料放入object\r\n        gameModel.people = object.Game.people;\r\n        gameModel.round = object.Game.round;\r\n    };\r\n    //連線錯誤時\r\n    ws.onerror = function (event) {\r\n    };\r\n    //連線關閉時觸發  \r\n    ws.onclose = function (event) {\r\n        gameModel.WebSocket_NumberOfPeople_Host();\r\n    };\r\n} \r\n\r\n//玩家從Websocket取得開始、再來一輪、關閉的訊息 (start、again、close)\r\nfunction WebSocket_GameStatus_Guest(){\r\n    //取得Websocket通訊網址\r\n    let ws = new WebSocket(\"wss://\" + gameModel.local_ID + \"/ws/v1/game/status/guest?activity_id=\"+ gameModel.activity_id +'&game_id=' + gameModel.game_id + '&game='+ gameModel.GameName)\r\n    //連線開啟時觸發 \r\n    ws.onopen = function (event) {\r\n    };\r\n    //接收到訊息時觸發  \r\n    ws.onmessage = function (event) {\r\n        var gameModel = require(\"Model\");\r\n        var object = JSON.parse(event.data)\r\n        gameModel.GameStatusMessage = object.Game.status;\r\n        gameModel.round = object.Game.round;\r\n        gameModel.gametimeCountDown = object.Game.second ;\r\n    };\r\n    //連線錯誤時\r\n    ws.onerror = function (event) {\r\n    };\r\n    //連線關閉時觸發  \r\n    ws.onclose = function (event) {\r\n        gameModel.WebSocket_GameStatus_Guest()\r\n    };\r\n} \r\n\r\n//主持人將開始、再一輪、關閉的訊息傳到Websocket (start、again、close)\r\nfunction WebSocket_GameStatus_Host(status,time){\r\n    //連線開啟時觸發 \r\n    gameModel.GameStatusWS_Host.onopen = function (event) {\r\n    };\r\n    //接收到訊息時觸發  \r\n    gameModel.GameStatusWS_Host.onmessage = function (event) {\r\n        var gameModel = require(\"Model\");\r\n        var object = JSON.parse(event.data)\r\n        gameModel.GameStatusMessage = object.Game.status;\r\n        gameModel.connet_ws = true;\r\n    };\r\n    //連線錯誤時\r\n    gameModel.GameStatusWS_Host.onerror = function (event) {\r\n    };\r\n    //連線關閉時觸發  \r\n    gameModel.GameStatusWS_Host.onclose = function (event) {\r\n        gameModel.connet_ws = false;\r\n        gameModel.GameStatusWS_Host = new WebSocket(\"wss://\" + gameModel.local_ID + \"/ws/v1/game/status/host?activity_id=\"+ gameModel.activity_id +'&game_id=' + gameModel.game_id + '&game='+ gameModel.GameName); //開啟遊戲狀態ws;\r\n        gameModel.WebSocket_GameStatus_Host(status,1000)\r\n    };\r\n    //等待1秒，等通道打開再執行推送資料給Websocket\r\n    setTimeout(function(){\r\n        if(gameModel.GameStatusWS_Host.readyState === WebSocket.OPEN){\r\n            if(status == \"gaming\" && gameModel.XMLTimeLimit == true)\r\n            {\r\n                gameModel.GameStatusWS_Host.send(JSON.stringify({\r\n                    Game: {\r\n                        status: status,\r\n                        round: gameModel.round,\r\n                        second: gameModel.gametimeCountDown,\r\n                    }}));\r\n            }\r\n            else\r\n            {\r\n                gameModel.GameStatusWS_Host.send(JSON.stringify({\r\n                    Game: {\r\n                        status: status,\r\n                        round: status == \"end\"? gameModel.round - 1 :  gameModel.round,\r\n                    }}));\r\n            }  \r\n        }\r\n        else\r\n        {\r\n            gameModel.connet_ws = false;\r\n        } \r\n    },time);\r\n} \r\n\r\n//玩家端每秒傳送分數給後端\r\nfunction WebSocket_UpDateScore_Guest(){\r\n    let ws = new WebSocket(\"wss://\" + gameModel.local_ID + \"/ws/v1/game/score?activity_id=\"+ gameModel.activity_id +'&game_id=' + gameModel.game_id + '&game='+ gameModel.GameName);\r\n\r\n    //連線開啟時觸發 \r\n    ws.onopen = function (event) {\r\n    };\r\n    //接收到訊息時觸發  \r\n    ws.onmessage = function (event) {\r\n        var gameModel = require(\"Model\");\r\n        var object = JSON.parse(event.data)\r\n    };\r\n    //連線錯誤時\r\n    ws.onerror = function (event) {\r\n    };\r\n    //連線關閉時觸發  \r\n    ws.onclose = function (event) {\r\n        if(gameModel.GameStatusMessage == \"gaming\")gameModel.WebSocket_UpDateScore_Guest()\r\n        else clearInterval(Interval);\r\n    };\r\n    var Interval = setInterval(function(){ \r\n        if(ws.readyState === WebSocket.OPEN){\r\n            ws.send(JSON.stringify({\r\n                Game: {\r\n                    status: gameModel.GameStatusMessage,\r\n                    round: gameModel.round - 1 ,\r\n                    score: gameModel.Score\r\n                },\r\n                User:{\r\n                    user_id: gameModel.User_id,\r\n                },\r\n            }));\r\n        }\r\n    }, 500);\r\n} \r\n\r\n//主持人從Websocket取得玩家中獎資料\r\nfunction WebSocket_NumberOfLottery_Host(){\r\n    //連線開啟時觸發 zx\r\n    gameModel.NumberOfLotteryWS_Host.onopen = function (event) {\r\n    };\r\n    //接收到訊息時觸發  \r\n    gameModel.NumberOfLotteryWS_Host.onmessage = function (event) {\r\n        var gameModel = require(\"Model\");\r\n        var object = JSON.parse(event.data)\r\n        gameModel.prize_total = object.Game.amount //獎品總數量\r\n        for(var i = 0;i < object.PrizeStaffs.length; i++)\r\n        {\r\n            if(gameModel.winner_id.includes(object.PrizeStaffs[i].id) == false)\r\n            {\r\n                gameModel.winner_id[i] = object.PrizeStaffs[i].id; //得獎者id\r\n                gameModel.winner_name[i] = object.PrizeStaffs[i].name //得獎人名稱\r\n                gameModel.winner_picture[i] = object.PrizeStaffs[i].avatar //得獎人照片\r\n                gameModel.prize_name_host[i] = object.PrizeStaffs[i].prize_name//獎品名稱\r\n                gameModel.WinnerData.SpawnNewWinner();\r\n            }  \r\n        }\r\n        if(gameModel.GameStatusMessage != \"end\" && gameModel.winner_name.length > 0 && gameModel.SpawnNewestWinner == true) gameModel.WinnerData.NewestWinner();\r\n        else if(gameModel.GameStatusMessage == \"end\") gameModel.NumberOfLotteryWS_Host.close();\r\n    };\r\n    //連線錯誤時\r\n    gameModel.NumberOfLotteryWS_Host.onerror = function (event) {\r\n    };\r\n    //連線關閉時觸發  \r\n    gameModel.NumberOfLotteryWS_Host.onclose = function (event) {\r\n        if(gameModel.GameStatusMessage == \"start\") {\r\n            gameModel.NumberOfLotteryWS_Host = new WebSocket(\"wss://\" + gameModel.local_ID + \"/ws/v1/game/winning/staff?activity_id=\"+ gameModel.activity_id +'&game_id=' + gameModel.game_id + '&game='+ gameModel.GameName); //開啟更新得獎人的ws\r\n            gameModel.WebSocket_NumberOfLottery_Host()\r\n        }\r\n    };\r\n} \r\n\r\n  //主持人從Websocket取得玩家中獎資料\r\n  function WebSocket_NumberOfLottery_Score_Host(){\r\n    //連線開啟時觸發 \r\n    gameModel.NumberOfLotteryWS_Host.onopen = function (event) {\r\n    };\r\n    //接收到訊息時觸發  \r\n    gameModel.NumberOfLotteryWS_Host.onmessage = function (event) {\r\n        var gameModel = require(\"Model\");\r\n        var object = JSON.parse(event.data)\r\n        gameModel.prize_total = object.Game.amount //獎品總數量\r\n        gameModel.WinnerData.ClearRank();\r\n        for(var i = 0;i < object.PrizeStaffs.length; i++)\r\n        {\r\n            gameModel.winner_id[i] = object.PrizeStaffs[i].id; //得獎者id\r\n            gameModel.winner_name[i] = object.PrizeStaffs[i].name //得獎人名稱\r\n            gameModel.winner_picture[i] = object.PrizeStaffs[i].avatar //得獎人照片\r\n            gameModel.prize_name_host[i] = object.PrizeStaffs[i].prize_name//獎品名稱\r\n            gameModel.winner_score[i] = object.PrizeStaffs[i].score//得獎人分數\r\n            gameModel.WinnerData.SpawnNewWinner();\r\n        }\r\n        if(gameModel.GameStatusMessage == \"calculate\") \r\n        {\r\n            gameModel.WinnerData.NextSence();\r\n            gameModel.NumberOfLotteryWS_Host.close();\r\n        }\r\n    };\r\n    //連線錯誤時\r\n    gameModel.NumberOfLotteryWS_Host.onerror = function (event) {\r\n    };\r\n    //連線關閉時觸發  \r\n    gameModel.NumberOfLotteryWS_Host.onclose = function (event) {\r\n        if(gameModel.GameStatusMessage == \"gaming\") {\r\n            gameModel.NumberOfLotteryWS_Host = new WebSocket(\"wss://\" + gameModel.local_ID + \"/ws/v1/game/winning/staff?activity_id=\"+ gameModel.activity_id +'&game_id=' + gameModel.game_id + '&game='+ gameModel.GameName); //開啟更新得獎人的ws\r\n            gameModel.WinnerData.WebSocket_NumberOfLottery_Host()\r\n        }\r\n    };\r\n}\r\n\r\n\r\n//取得動態參數\r\nfunction getQueryVariable(variable){\r\n    var query = window.location.search.substring(1);\r\n    var vars = query.split(\"&\");\r\n    for (var i = 0; i < vars.length; i++) \r\n    {\r\n        var pair = vars[i].split(\"=\");\r\n        if(pair[0] == variable) return pair[1];\r\n    }\r\n    return(\"\");\r\n}\r\n\r\n//處理leLiffState取得activity_id和game_id\r\nfunction HandleLiffState(){\r\n    if (gameModel.activity_id == \"\" || gameModel.game_id == \"\")\r\n    {\r\n        if (gameModel.liffstate.length > 13) gameModel.liffstate = gameModel.liffstate.substr(17 , gameModel.liffstate.length)\r\n    }\r\n    \r\n    if (gameModel.liffstate.includes(\"%26game_id%3D\")) //%3f是?  %26是&  %3d是=\r\n    {\r\n        var params = gameModel.liffstate.split(\"%26game_id%3D\")\r\n        gameModel.activity_id = params[0]\r\n        if(params.length == 2)\r\n        {\r\n           params = params[1].split(\"#mst_challenge\")\r\n           gameModel.game_id = params[0]\r\n        }\r\n    }\r\n}\r\n\r\n//取得Cookie資料\r\nfunction readCookie(name) {\r\n    var nameEQ = name + \"=\";\r\n    var ca = document.cookie.split(';'); //取得cookie並用;區分開來儲存在ca\r\n    for(var i = 0;i < ca.length;i++) {\r\n        var c = ca[i];\r\n        while (c.charAt(0) ==' ') c = c.substring(1,c.length);\r\n        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\r\n    }\r\n    return null;\r\n}  \r\n\r\nvar gameModel = require(\"Model\");\r\ngameModel.activity_id =  getQueryVariable(\"activity_id\")\r\ngameModel.game_id =  getQueryVariable(\"game_id\")\r\ngameModel.liffstate = getQueryVariable(\"liff.state\")\r\ngameModel.session_id = readCookie('chatroom_session')\r\nHandleLiffState();\r\n\r\n  \r\n    \r\n\r\n\r\n\r\n\r\n\r\n\r\n"]}