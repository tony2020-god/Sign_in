{"version":3,"sources":["assets\\1_redpack\\遊戲模塊\\Guest4_ShakeRedpacket.js"],"names":["gameModel","require","cc","Class","Component","properties","onLoad","GetPrize","shakecount","start","systemEvent","setAccelerometerEnabled","on","SystemEvent","EventType","DEVICEMOTION","onDeviceMotionEvent","event","stand","x","acc","toFixed","y","z","speed","Math","abs","off","Lottery_Guest","scheduleOnce","GameStatusMessage"],"mappings":";;;;;;AAAA,IAAIA,SAAS,GAAGC,OAAO,CAAC,OAAD,CAAvB,EAEA;;;AACAC,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE,EAHP;AAQL;AAEAC,EAAAA,MAVK,oBAUK;AACN,SAAKC,QAAL,GAAgB,KAAhB,CADM,CACgB;;AACtB,SAAKC,UAAL,GAAkB,CAAlB,CAFM,CAEc;AACvB,GAbI;AAeLC,EAAAA,KAfK,mBAeI;AACLP,IAAAA,EAAE,CAACQ,WAAH,CAAeC,uBAAf,CAAuC,IAAvC,EADK,CAC0C;;AAC/CT,IAAAA,EAAE,CAACQ,WAAH,CAAeE,EAAf,CAAkBV,EAAE,CAACW,WAAH,CAAeC,SAAf,CAAyBC,YAA3C,EAAyD,KAAKC,mBAA9D,EAAmF,IAAnF;AACH,GAlBI;AAoBLA,EAAAA,mBApBK,+BAoBgBC,KApBhB,EAoBuB;AACpB,QAAIC,KAAK,GAAG,GAAZ;AACA,QAAIC,CAAC,GAAGF,KAAK,CAACG,GAAN,CAAUD,CAAV,CAAYE,OAAZ,CAAoB,CAApB,CAAR;AACA,QAAIC,CAAC,GAAGL,KAAK,CAACG,GAAN,CAAUE,CAAV,CAAYD,OAAZ,CAAoB,CAApB,CAAR;AACA,QAAIE,CAAC,GAAGN,KAAK,CAACG,GAAN,CAAUG,CAAV,CAAYF,OAAZ,CAAoB,CAApB,CAAR;AACA,SAAKG,KAAL,GAAaC,IAAI,CAACC,GAAL,CAASP,CAAC,GAACD,KAAX,IAAoBO,IAAI,CAACC,GAAL,CAASJ,CAAC,GAACJ,KAAX,CAApB,GAAwCO,IAAI,CAACC,GAAL,CAASH,CAAC,GAACL,KAAX,CAArD,CALoB,CAKoD;;AACxE,QAAG,KAAKM,KAAL,GAAa,CAAhB,EAAoB;AACpB;AACI,aAAKhB,UAAL,GADJ,CACyB;;AACrB,YAAG,KAAKA,UAAL,IAAmB,CAAnB,IAAyB,KAAKD,QAAL,IAAiB,KAA7C,EAAoD;AACpD;AACIL,YAAAA,EAAE,CAACQ,WAAH,CAAeC,uBAAf,CAAuC,KAAvC,EADJ,CACoD;;AAChDT,YAAAA,EAAE,CAACQ,WAAH,CAAeiB,GAAf,CAAmBzB,EAAE,CAACW,WAAH,CAAeC,SAAf,CAAyBC,YAA5C,EAA0D,KAAKC,mBAA/D,EAAoF,IAApF;AACA,iBAAKT,QAAL,GAAgB,IAAhB;AACAP,YAAAA,SAAS,CAAC4B,aAAV;AACA,iBAAKC,YAAL,CAAkB,YAAU;AACvB7B,cAAAA,SAAS,CAAC8B,iBAAV,GAA8B,KAA9B;AACL,aAFA,EAEC,CAFD;AAGH;AACJ,OAbD,MAcM,KAAKtB,UAAL,GAAkB,CAAlB,CApBc,CAoBO;;AAClC,GAzCI,CA2CL;;AA3CK,CAAT","sourceRoot":"/","sourcesContent":["var gameModel = require(\"Model\");\r\n\r\n///玩家在遊戲中，打開陀螺儀，搖紅包判定抽獎js\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        \r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.GetPrize = false;//是否拿到獎品\r\n        this.shakecount = 0;//搖的次數\r\n    },\r\n\r\n    start () {\r\n        cc.systemEvent.setAccelerometerEnabled(true);  //打開加速儀\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\r\n    },\r\n\r\n    onDeviceMotionEvent (event) {\r\n            var stand = 0.2;\r\n            var x = event.acc.x.toFixed(2); \r\n            var y = event.acc.y.toFixed(2); \r\n            var z = event.acc.z.toFixed(2); \r\n            this.speed = Math.abs(x-stand) + Math.abs(y-stand) + Math.abs(z-stand); //搖晃程度\r\n            if(this.speed > 2 ) //搖晃程度須超過2\r\n            {\r\n                this.shakecount ++ ; //搖晃次數增加1\r\n                if(this.shakecount >= 5 &&  this.GetPrize == false) //搖晃次數到達5則判定有無中獎\r\n                {\r\n                    cc.systemEvent.setAccelerometerEnabled(false);  //打開加速儀\r\n                    cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\r\n                    this.GetPrize = true;\r\n                    gameModel.Lottery_Guest();\r\n                    this.scheduleOnce(function(){\r\n                         gameModel.GameStatusMessage = \"end\"\r\n                   },3);\r\n                }\r\n            }\r\n            else  this.shakecount = 0; //若中間有搖晃程度未超過2，則搖晃次數歸0\r\n    },\r\n    \r\n    // update (dt) {},\r\n});\r\n"]}