{"version":3,"sources":["assets\\2_ropepack\\遊戲模塊\\Guest4_CatchRedpacket.js"],"names":["gameModel","require","cc","Class","Component","properties","aniRedPacket","type","Node","aniButton","aniHand","onLoad","director","getPhysicsManager","enabled","start","RopeCount","ButtunClickCheck","aniButtunStates","schedule","CheckCountinuePress","Rope","getComponent","sp","Skeleton","setAnimation","timeScale","addAnimation","unschedule","Lottery_Guest","scheduleOnce","result","GameStatusMessage"],"mappings":"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","sourceRoot":"/","sourcesContent":["var gameModel = require(\"Model\"); //全域變數gameModel 不須加this就能提取\r\n\r\n///玩家在遊戲中套紅包判定抽獎js\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        aniRedPacket:{\r\n          default: null,\r\n          type: cc.Node\r\n        },\r\n\r\n        aniButton:{\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        aniHand:{\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n    },\r\n\r\n\r\n    onLoad () {\r\n        cc.director.getPhysicsManager().enabled = true;\r\n    },\r\n\r\n    start () {\r\n        this.RopeCount = 0;\r\n        this.ButtunClickCheck = 0;\r\n        this.aniButtunStates = \"None\";\r\n        //每1秒鐘檢查是否有持續按按鈕\r\n        this.schedule(this.CheckCountinuePress, 0.5);\r\n    },\r\n\r\n    //按下套紅包按鈕\r\n    Rope(){\r\n        if(this.aniButtunStates == \"None\") //第一次點擊時，變更按鈕、紅包動畫和手指動畫的速度\r\n        {\r\n            this.aniButtunStates = \"開始套紅包\";\r\n            this.aniButton.getComponent(sp.Skeleton).setAnimation(0,\"animation3\",true);   \r\n            this.aniHand.getComponent(sp.Skeleton).timeScale = 2.5;\r\n            this.aniRedPacket.getComponent(sp.Skeleton).setAnimation(0,\"catch1-2\",false);\r\n            this.aniRedPacket.getComponent(sp.Skeleton).addAnimation(0,\"catch1-3\",true);\r\n        }\r\n        else if(this.aniButtunStates == \"開始套紅包\" && this.RopeCount <= 20) //點擊到指定次數時判斷有無中獎\r\n        {\r\n            this.RopeCount ++ ;\r\n            if(this.RopeCount == 20) \r\n            {\r\n                this.unschedule(this.CheckCountinuePress); //取消計時器\r\n                gameModel.Lottery_Guest();\r\n                this.scheduleOnce(function(){\r\n                   if(gameModel.result == \"thanks\") this.aniRedPacket.getComponent(sp.Skeleton).setAnimation(0,\"catch1-5\",false); //沒中獎切換到飛走動畫\r\n                   else this.aniRedPacket.getComponent(sp.Skeleton).setAnimation(0,\"catch1-4\",false); //中獎切換到拉走動畫\r\n                   this.scheduleOnce(function(){\r\n                    gameModel.GameStatusMessage = \"end\"\r\n                   },1.5);\r\n                },3);\r\n            }\r\n        }\r\n    },\r\n\r\n    //若太久沒按下套紅包按鈕，計數會歸0\r\n    CheckCountinuePress(){\r\n       if(this.RopeCount != this.ButtunClickCheck) this.ButtunClickCheck = this.RopeCount;\r\n       else \r\n       {\r\n        this.RopeCount = 0\r\n        this.ButtunClickCheck = 0\r\n       }\r\n    }\r\n\r\n    // update (dt) {},\r\n});\r\n"]}