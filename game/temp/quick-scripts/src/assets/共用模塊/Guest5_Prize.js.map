{"version":3,"sources":["assets\\共用模塊\\Guest5_Prize.js"],"names":["gameModel","require","RecordItem","cc","Class","Component","properties","items","type","Prefab","ResultWindow","Node","Note","CannotNextRound","SpriteFrame","onLoad","prize_parents","find","Title","BackGround","start","getComponent","Sprite","spriteFrame","TopTitle","Prize_BackGround","result","AlreadyPlayed","CannotJoinGame","active","getChildByName","sp","Skeleton","setAnimation","AllowRePrize","setData","GameStateJudge","i","prize_name_guest","length","node","instantiate","parent","exchangePrize","setSiblingIndex","obj","updateInfo","CloseResult","update","dt","GameStatusMessage","director","loadScene","BackGround_Theme"],"mappings":"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","sourceRoot":"/","sourcesContent":["var gameModel = require(\"Model\");\r\nvar RecordItem = require('Guest5_PrizeRecordItem')\r\n\r\n///生成玩家中獎列表，判斷有無中獎或收到again訊息js\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        \r\n        items: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        ResultWindow: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        Note: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        CannotNextRound:{\r\n            default:null,\r\n            type:cc.SpriteFrame\r\n        },\r\n    },\r\n\r\n    onLoad () {\r\n        this.prize_parents = cc.find(\"畫布/已獲得的獎品列表/view/內容\")\r\n        this.Title = cc.find(\"畫布/場景/上方框\")\r\n        this.BackGround = cc.find(\"畫布/場景/背景\")\r\n    },\r\n    \r\n    start () {\r\n        this.Title.getComponent(cc.Sprite).spriteFrame = gameModel.TopTitle;\r\n        this.BackGround.getComponent(cc.Sprite).spriteFrame = gameModel.Prize_BackGround;\r\n        if(gameModel.result == 'thanks' && gameModel.AlreadyPlayed == 0 && gameModel.CannotJoinGame != \"錯誤: 該場次遊戲不允許重複中獎，您已中獎，無法參加下一輪遊戲\") \r\n        {\r\n            this.ResultWindow.active = true;  \r\n            this.ResultWindow.getChildByName(\"得獎結果動畫\").getComponent(sp.Skeleton).setAnimation(0,\"lost\",true);  \r\n        }\r\n        else if(gameModel.result != 'thanks' && gameModel.AlreadyPlayed == 0 && gameModel.CannotJoinGame != \"錯誤: 該場次遊戲不允許重複中獎，您已中獎，無法參加下一輪遊戲\") \r\n        {\r\n            this.ResultWindow.active = true;\r\n            this.ResultWindow.getChildByName(\"得獎結果動畫\").getComponent(sp.Skeleton).setAnimation(0,\"win\",true);\r\n            if(gameModel.AllowRePrize == \"close\") \r\n            {\r\n                gameModel.CannotJoinGame = \"錯誤: 該場次遊戲不允許重複中獎，您已中獎，無法參加下一輪遊戲\";\r\n                this.Note.getComponent(cc.Sprite).spriteFrame = this.CannotNextRound;\r\n            }   \r\n        }\r\n        else if(gameModel.CannotJoinGame == \"錯誤: 該場次遊戲不允許重複中獎，您已中獎，無法參加下一輪遊戲\") this.Note.getComponent(cc.Sprite).spriteFrame = this.CannotNextRound;\r\n        this.setData();\r\n        this.GameStateJudge = true\r\n    },\r\n\r\n    setData(){\r\n        for(var i = 0; i < gameModel.prize_name_guest.length; i++){\r\n            var node = cc.instantiate(this.items)//clone已有節點，生成items格式\r\n            node.parent = this.prize_parents\r\n            if(gameModel.exchangePrize[i] == \"yes\") node.setSiblingIndex(gameModel.prize_name_guest.length);\r\n            else node.setSiblingIndex(0)\r\n            var obj = node.getComponent(RecordItem)//抓取RecordItem\r\n            obj.updateInfo(i);\r\n        }\r\n    },\r\n    \r\n    CloseResult(){\r\n      this.ResultWindow.active = false;\r\n    },\r\n\r\n    update (dt) {\r\n        if(gameModel.GameStatusMessage == \"open\" && gameModel.CannotJoinGame != \"錯誤: 該場次遊戲不允許重複中獎，您已中獎，無法參加下一輪遊戲\" && this.GameStateJudge == true)\r\n        {\r\n          gameModel.AlreadyPlayed = 0;\r\n          gameModel.result = 'thanks';\r\n          cc.director.loadScene(\"Guest1_JoinGame\"+ gameModel.BackGround_Theme);\r\n        } \r\n    },\r\n});\r\n"]}