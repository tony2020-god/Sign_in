{"version":3,"sources":["assets\\3_whack_a_mole\\遊戲模塊\\Guest_MouseManager.js"],"names":["gameModel","require","cc","Class","Component","properties","isLive","tag","dead","type","SpriteFrame","bomb","AddPoint","Node","MinusPoint","onLoad","HolesParent","find","GameManager","getComponent","GameScore","start","node","on","Hit","StartPosition","position","HitAniTarget","delytime","AddPoint_OriPos","MinusPoint_OriPos","mouseani","stop","setPosition","Sprite","spriteFrame","Label","string","Score","active","HitAnimation","scheduleOnce","opacity","ResetHole","GetData","randomNodeIndex","randomSpriteFrameIndex","MouseAnimation","tween","by","v2","delay","call","hitani","to","x","mouseIndexArr","splice","indexOf"],"mappings":"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","sourceRoot":"/","sourcesContent":["var gameModel = require(\"Model\"); //全域變數gameModel 不須加this就能提取\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        isLive: false,  //代表老鼠是否被擊暈\r\n        tag : null,\r\n        dead: {\r\n            default: null,\r\n            type: cc.SpriteFrame\r\n        },\r\n        bomb: {\r\n            default: null,\r\n            type: cc.SpriteFrame\r\n        },\r\n        AddPoint: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        MinusPoint: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.HolesParent = cc.find(\"畫布/場景/地鼠洞\")\r\n        this.GameManager = cc.find(\"畫布\").getComponent(\"Guest4_Whack_a_mole\")\r\n        this.GameScore = cc.find(\"畫布/場景/得分框/分數\")\r\n    },\r\n\r\n    start () {\r\n        this.node.on(\"touchstart\", this.Hit, this);\r\n        this.StartPosition = this.node.position;\r\n        this.HitAniTarget = null;\r\n        this.delytime = 0\r\n        this.AddPoint_OriPos = this.AddPoint.position;\r\n        this.MinusPoint_OriPos = this.MinusPoint.position;\r\n    },\r\n\r\n    Hit() {\r\n        if(this.isLive == true)\r\n        {\r\n           this.mouseani.stop();\r\n           this.isLive = false;\r\n           this.node.setPosition(-462.525, 414.31, 0)\r\n           this.node.getComponent(cc.Sprite).spriteFrame = this.tag == 2 ? this.bomb : this.dead  \r\n           if(this.tag < 2) //執行老鼠的算分函數刷新當前遊戲分數及打到動畫\r\n           {\r\n              if(this.tag == 0) \r\n              {\r\n                this.AddPoint.getComponent(cc.Label).string = 1\r\n                gameModel.Score += 1\r\n              }\r\n              else {\r\n                this.AddPoint.getComponent(cc.Label).string = 3\r\n                gameModel.Score += 3\r\n              }\r\n              this.AddPoint.active = true;\r\n              this.HitAniTarget = this.AddPoint;\r\n           }\r\n           else if (this.tag == 2) \r\n           {\r\n             gameModel.Score -= 1\r\n             gameModel.Score = gameModel.Score < 0 ? 0 : gameModel.Score; //判斷當前分數是否低於0，如果低於零則重置爲0\r\n             this.MinusPoint.active = true;\r\n             this.HitAniTarget = this.MinusPoint;\r\n           }\r\n           this.HitAnimation()\r\n           this.GameScore.getComponent(cc.Label).string = gameModel.Score;\r\n           this.scheduleOnce(function() { \r\n             this.HitAniTarget.opacity = 255\r\n             this.AddPoint.active = false;\r\n             this.AddPoint.position = this.AddPoint_OriPos\r\n             this.MinusPoint.active = false;\r\n             this.MinusPoint.position = this.MinusPoint_OriPos\r\n             this.ResetHole();\r\n           }, 0.5);\r\n        }\r\n    },\r\n\r\n    GetData(randomNodeIndex,randomSpriteFrameIndex){\r\n        this.randomNodeIndex = randomNodeIndex;\r\n        if(randomSpriteFrameIndex == 2) this.delytime = 1\r\n        else this.delytime = 0.5\r\n    },\r\n\r\n    //老鼠出現到消失動畫\r\n    MouseAnimation(){\r\n        this.mouseani = cc.tween(this.node)\r\n        .by(0.5, { position: cc.v2(0, 520)})\r\n        .delay(this.delytime)\r\n        .by(0.5, { position: cc.v2(0, -510)})\r\n        .call(() => {this.ResetHole();})\r\n        .start()\r\n    },\r\n\r\n    //分數往上飄動畫\r\n    HitAnimation(){\r\n        this.hitani = cc.tween(this.HitAniTarget)\r\n        .to(0.5, {opacity: 0, position: cc.v2(this.HitAniTarget.position.x, 40)})\r\n        .start()\r\n    },\r\n\r\n    ResetHole(){\r\n        this.node.position = this.StartPosition\r\n        this.GameManager.mouseIndexArr.splice(this.GameManager.mouseIndexArr.indexOf(this.randomNodeIndex,0), 1); //已產生老鼠的陣列中，刪除目前資料的陣列位置\r\n    } \r\n    // update (dt) {},\r\n});\r\n"]}