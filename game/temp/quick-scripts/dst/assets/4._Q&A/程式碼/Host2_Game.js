
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/4._Q&A/程式碼/Host2_Game.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e75dbxyPdZGi5ZhayAt05CV', 'Host2_Game');
// 4._Q&A/程式碼/Host2_Game.js

"use strict";

var gameModel = require("Model");

var TimeCount_js = require("Host3_GameTimeCountDown");

cc.Class({
  "extends": cc.Component,
  properties: {
    Result: {
      "default": [],
      type: cc.Sprite
    },
    ResultAnswered: {
      "default": [],
      type: cc.Node
    },
    PeopleAnswered: {
      "default": null,
      type: cc.Label
    },
    NowQuestionCount: {
      "default": null,
      type: cc.Label
    },
    Options: {
      "default": [],
      type: cc.Node
    },
    Question: {
      "default": null,
      type: cc.Label
    },
    Rank: {
      "default": [],
      type: cc.Node
    },
    ShowAnswerString: {
      "default": null,
      type: cc.Label
    },
    TimeBar: {
      "default": null,
      type: cc.Sprite
    },
    Timelight: {
      "default": null,
      type: cc.Sprite
    },
    RedTimeBar: {
      "default": null,
      type: cc.SpriteFrame
    },
    RedTimelight: {
      "default": null,
      type: cc.SpriteFrame
    }
  },
  onLoad: function onLoad() {
    this.timenode = cc.find("畫布/秒數處理/秒數");
    this.tensecsound = cc.find("畫布").getComponent(TimeCount_js);
    gameModel.XMLTimeLimit = true;
    gameModel.gametimelimit = 12;
    gameModel.gametimeCountDown = 12;
    this.lerp = 1.1 / gameModel.gametimelimit * 0.03;
    this.count = 0;
    this.c = 0;
    this.Answer = 2;
    this.alreadyred = false;
    this.schedule(this.TimeBarProgress, 0.03);
  },
  start: function start() {
    gameModel.GameStatusMessage = "open";
    this.ColorString = this.node.getComponent('ColorString'); //this.Question.string = gameModel.Question[gameModel.QuestionCount]
    //this.WebSocket_NumberOfLottery_Host();

    this.SeeResult = false;
    this.PeopleAnswered.string = 10;
    gameModel.AnswerResult = [10, 15, 20, 30];
    gameModel.people = 75;
    this.NowQuestionCount.string = gameModel.QuestionCount + "/" + gameModel.Question.length;

    for (var i = 0; i < 4; i++) {
      //this.Options[i].getChildByName("選項文字").getComponent(cc.Label).string = gameModel.Options[i];
      this.OpacityAni_Start(this.Options[i].getChildByName("選項文字"));
      this.OpacityAni_Start(this.Options[i].getChildByName("選項字母"));
    }

    this.SpawnNewWinner();
    console.log(this.ColorString);
    console.log(gameModel);
  },
  //列出得人獎物件
  SpawnNewWinner: function SpawnNewWinner() {
    for (var i = 0; i < 5; i++) {
      var self = this;
      this.Rank[i].getChildByName("玩家名子").getComponent(cc.Label).string = "甜甜"; //gameModel.winner_name[i]

      this.Rank[i].getChildByName("玩家分數").getChildByName("分數").getComponent(cc.Label).string = "123"; //gameModel.winner_score[i]

      this.Rank[i].getChildByName("玩家耗時").getChildByName("耗時").getComponent(cc.Label).string = "321"; //gameModel.winner_time[i]
      //遠端載入: 網址轉圖片

      /*         cc.assetManager.loadRemote(gameModel.winner_picture[i],{ext :'.jpg'||'.png'},function(err,texture)
              { 
                if(err) console.log("錯誤")
                else
                {
                var picture = new cc.SpriteFrame(texture); //texture 轉 SpriteFrame
                self.Rank[i].getChildByName("頭相框").getChildByName("遮罩").getChildByName("玩家頭像").getComponent(cc.Sprite).spriteFrame = picture;
                }
              }); */
    }

    this.schedule(this.OpacityAni, 0.2);
  },
  OpacityAni: function OpacityAni() {
    this.PlayDarkAni(this.Rank[this.c].getChildByName("黑布"));
    this.c++;
    console.log(this.c);
    if (this.c == 5) this.unschedule(this.OpacityAni);
  },
  AnswerButton: function AnswerButton() {
    if (this.SeeResult == false) {
      //gameModel.WebSocket_GameStatus_Host("end",0.1)
      gameModel.GameStatusMessage = "end";
    } else {
      //gameModel.WebSocket_GameStatus_Host("final",0.1)
      if (gameModel.QuestionCount == gameModel.Question.length) cc.director.loadScene("Host3_Last");else {
        // gameModel.WebSocket_GameStatus_Host("next",0.1)
        gameModel.QuestionCount++;
        cc.director.loadScene("Host1_Question");
      }
    }
  },
  PrintResult: function PrintResult() {
    this.SeeResult = true;
    this.timenode.active = false;
    this.ShowAnswerString.string = gameModel.QuestionCount == gameModel.Question.length ? "結算" : "下一題";
    this.TimeBar.fillRange = 0;
    this.schedule(this.ProgressBar, 0.01);

    for (var i = 0; i < 4; i++) {
      this.ResultAnswered[i].active = true;
      this.ResultAnswered[i].getComponent(cc.Label).string = gameModel.AnswerResult[i] + "人"; //this.Result[i].fillRange = -gameModel.AnswerResult[i] / gameModel.people ;

      this.i = 0;
      if (i == this.Answer) continue;
      this.Options[i].color = this.Options[i].getChildByName("選項文字").color = this.Options[i].getChildByName("選項字母").color = this.ColorString.colorOfString('#045858');
    }

    for (var i = 0; i < 5; i++) {
      this.PlayBrightAni(this.Rank[i].getChildByName("黑布"));
    }
  },
  PlayBrightAni: function PlayBrightAni(node) {
    cc.tween(node).to(2, {
      opacity: 255
    }).start();
  },
  PlayDarkAni: function PlayDarkAni(node) {
    cc.tween(node).to(2, {
      opacity: 0
    }).start();
  },
  OpacityAni_Start: function OpacityAni_Start(node) {
    node.opacity = 0;
    cc.tween(node).to(0.3, {
      opacity: 255
    }).start();
  },
  OpacityAni_Time: function OpacityAni_Time() {
    cc.tween(this.Timelight.node).repeatForever(cc.tween().to(0.2, {
      opacity: 0
    }).to(0.2, {
      opacity: 255
    })).start();
  },
  ProgressBar: function ProgressBar() {
    this.Result[this.i].fillRange -= 0.01;

    if (this.Result[this.i].fillRange <= -gameModel.AnswerResult[this.i] / gameModel.people) {
      this.unschedule(this.ProgressBar);
      this.i++;
      if (this.i > 3) return;
      this.schedule(this.ProgressBar, 0.01);
    }
  },
  TimeBarProgress: function TimeBarProgress() {
    this.TimeBar.fillRange -= this.lerp;
    this.count++;

    if (gameModel.gametimeCountDown == 10 && this.alreadyred == false) {
      this.alreadyred = true;
      this.TimeBar.spriteFrame = this.RedTimeBar;
      this.Timelight.spriteFrame = this.RedTimelight;
      this.OpacityAni_Time();
    }

    if (this.TimeBar.fillRange < 0) {
      this.Timelight.node.active = false;
      this.unschedule(this.TimeBarProgress);
    }
  },
  update: function update(dt) {
    if (gameModel.GameStatusMessage == "end" && this.SeeResult == false) {
      cc.audioEngine.stop(this.tensecsound.currentsound);
      this.PrintResult();
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcNC5fUSZBXFznqIvlvI/norxcXEhvc3QyX0dhbWUuanMiXSwibmFtZXMiOlsiZ2FtZU1vZGVsIiwicmVxdWlyZSIsIlRpbWVDb3VudF9qcyIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwiUmVzdWx0IiwidHlwZSIsIlNwcml0ZSIsIlJlc3VsdEFuc3dlcmVkIiwiTm9kZSIsIlBlb3BsZUFuc3dlcmVkIiwiTGFiZWwiLCJOb3dRdWVzdGlvbkNvdW50IiwiT3B0aW9ucyIsIlF1ZXN0aW9uIiwiUmFuayIsIlNob3dBbnN3ZXJTdHJpbmciLCJUaW1lQmFyIiwiVGltZWxpZ2h0IiwiUmVkVGltZUJhciIsIlNwcml0ZUZyYW1lIiwiUmVkVGltZWxpZ2h0Iiwib25Mb2FkIiwidGltZW5vZGUiLCJmaW5kIiwidGVuc2Vjc291bmQiLCJnZXRDb21wb25lbnQiLCJYTUxUaW1lTGltaXQiLCJnYW1ldGltZWxpbWl0IiwiZ2FtZXRpbWVDb3VudERvd24iLCJsZXJwIiwiY291bnQiLCJjIiwiQW5zd2VyIiwiYWxyZWFkeXJlZCIsInNjaGVkdWxlIiwiVGltZUJhclByb2dyZXNzIiwic3RhcnQiLCJHYW1lU3RhdHVzTWVzc2FnZSIsIkNvbG9yU3RyaW5nIiwibm9kZSIsIlNlZVJlc3VsdCIsInN0cmluZyIsIkFuc3dlclJlc3VsdCIsInBlb3BsZSIsIlF1ZXN0aW9uQ291bnQiLCJsZW5ndGgiLCJpIiwiT3BhY2l0eUFuaV9TdGFydCIsImdldENoaWxkQnlOYW1lIiwiU3Bhd25OZXdXaW5uZXIiLCJjb25zb2xlIiwibG9nIiwic2VsZiIsIk9wYWNpdHlBbmkiLCJQbGF5RGFya0FuaSIsInVuc2NoZWR1bGUiLCJBbnN3ZXJCdXR0b24iLCJkaXJlY3RvciIsImxvYWRTY2VuZSIsIlByaW50UmVzdWx0IiwiYWN0aXZlIiwiZmlsbFJhbmdlIiwiUHJvZ3Jlc3NCYXIiLCJjb2xvciIsImNvbG9yT2ZTdHJpbmciLCJQbGF5QnJpZ2h0QW5pIiwidHdlZW4iLCJ0byIsIm9wYWNpdHkiLCJPcGFjaXR5QW5pX1RpbWUiLCJyZXBlYXRGb3JldmVyIiwic3ByaXRlRnJhbWUiLCJ1cGRhdGUiLCJkdCIsImF1ZGlvRW5naW5lIiwic3RvcCIsImN1cnJlbnRzb3VuZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxTQUFTLEdBQUdDLE9BQU8sQ0FBQyxPQUFELENBQXZCOztBQUNBLElBQUlDLFlBQVksR0FBR0QsT0FBTyxDQUFDLHlCQUFELENBQTFCOztBQUVBRSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDVEMsSUFBQUEsTUFBTSxFQUFFO0FBQ1AsaUJBQVMsRUFERjtBQUVQQyxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ007QUFGRixLQURDO0FBTVZDLElBQUFBLGNBQWMsRUFBRTtBQUNkLGlCQUFTLEVBREs7QUFFZEYsTUFBQUEsSUFBSSxFQUFFTCxFQUFFLENBQUNRO0FBRkssS0FOTjtBQVdWQyxJQUFBQSxjQUFjLEVBQUM7QUFDYixpQkFBUyxJQURJO0FBRWJKLE1BQUFBLElBQUksRUFBRUwsRUFBRSxDQUFDVTtBQUZJLEtBWEw7QUFnQlZDLElBQUFBLGdCQUFnQixFQUFDO0FBQ2YsaUJBQVMsSUFETTtBQUVmTixNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ1U7QUFGTSxLQWhCUDtBQXFCVkUsSUFBQUEsT0FBTyxFQUFDO0FBQ04saUJBQVMsRUFESDtBQUVOUCxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ1E7QUFGSCxLQXJCRTtBQTBCVkssSUFBQUEsUUFBUSxFQUFDO0FBQ1AsaUJBQVMsSUFERjtBQUVQUixNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ1U7QUFGRixLQTFCQztBQStCVkksSUFBQUEsSUFBSSxFQUFDO0FBQ0gsaUJBQVMsRUFETjtBQUVIVCxNQUFBQSxJQUFJLEVBQUVMLEVBQUUsQ0FBQ1E7QUFGTixLQS9CSztB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QUFWLElBQStCLEVBQS9CLElBQXFDLEtBQUtLLFVBQUwsSUFBbUIsS0FBM0QsRUFDQTtBQUNFLFdBQUtBLFVBQUwsR0FBa0IsSUFBbEI7QUFDQSxXQUFLakIsT0FBTCxDQUFhdUQsV0FBYixHQUEyQixLQUFLckQsVUFBaEM7QUFDQSxXQUFLRCxTQUFMLENBQWVzRCxXQUFmLEdBQTZCLEtBQUtuRCxZQUFsQztBQUNBLFdBQUtpRCxlQUFMO0FBQ0Q7O0FBRUQsUUFBSSxLQUFLckQsT0FBTCxDQUFhNkMsU0FBYixHQUF5QixDQUE3QixFQUNBO0FBQ0UsV0FBSzVDLFNBQUwsQ0FBZXNCLElBQWYsQ0FBb0JxQixNQUFwQixHQUE2QixLQUE3QjtBQUNBLFdBQUtMLFVBQUwsQ0FBZ0IsS0FBS3BCLGVBQXJCO0FBQ0Q7QUFDRixHQW5PSTtBQXFPTHFDLEVBQUFBLE1Bck9LLGtCQXFPR0MsRUFyT0gsRUFxT087QUFDUixRQUFHNUUsU0FBUyxDQUFDd0MsaUJBQVYsSUFBK0IsS0FBL0IsSUFBd0MsS0FBS0csU0FBTCxJQUFrQixLQUE3RCxFQUNBO0FBQ0V4QyxNQUFBQSxFQUFFLENBQUMwRSxXQUFILENBQWVDLElBQWYsQ0FBb0IsS0FBS25ELFdBQUwsQ0FBaUJvRCxZQUFyQztBQUNBLFdBQUtqQixXQUFMO0FBQ0Q7QUFDSjtBQTNPSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZ2FtZU1vZGVsID0gcmVxdWlyZShcIk1vZGVsXCIpO1xyXG52YXIgVGltZUNvdW50X2pzID0gcmVxdWlyZShcIkhvc3QzX0dhbWVUaW1lQ291bnREb3duXCIpO1xyXG5cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgIFJlc3VsdCA6e1xyXG4gICAgICAgIGRlZmF1bHQ6IFtdLFxyXG4gICAgICAgIHR5cGU6IGNjLlNwcml0ZVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgUmVzdWx0QW5zd2VyZWQgOntcclxuICAgICAgICBkZWZhdWx0OiBbXSxcclxuICAgICAgICB0eXBlOiBjYy5Ob2RlXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICBQZW9wbGVBbnN3ZXJlZDp7XHJcbiAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICB9LFxyXG5cclxuICAgICAgTm93UXVlc3Rpb25Db3VudDp7XHJcbiAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICB0eXBlOiBjYy5MYWJlbFxyXG4gICAgICB9LFxyXG4gICAgICBcclxuICAgICAgT3B0aW9uczp7XHJcbiAgICAgICAgZGVmYXVsdDogW10sXHJcbiAgICAgICAgdHlwZTogY2MuTm9kZVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgUXVlc3Rpb246e1xyXG4gICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgdHlwZTogY2MuTGFiZWxcclxuICAgICAgfSxcclxuXHJcbiAgICAgIFJhbms6e1xyXG4gICAgICAgIGRlZmF1bHQ6IFtdLFxyXG4gICAgICAgIHR5cGU6IGNjLk5vZGVcclxuICAgICAgfSxcclxuXHJcbiAgICAgIFNob3dBbnN3ZXJTdHJpbmc6e1xyXG4gICAgICAgIGRlZmF1bHQ6IG51bGwsXHJcbiAgICAgICAgdHlwZTogY2MuTGFiZWxcclxuICAgICAgfSxcclxuICAgICAgIFxyXG4gICAgICBUaW1lQmFyOntcclxuICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgIHR5cGU6IGNjLlNwcml0ZVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgVGltZWxpZ2h0OntcclxuICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgIHR5cGU6IGNjLlNwcml0ZVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgUmVkVGltZUJhcjp7XHJcbiAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICB0eXBlOiBjYy5TcHJpdGVGcmFtZVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgUmVkVGltZWxpZ2h0OntcclxuICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgIHR5cGU6IGNjLlNwcml0ZUZyYW1lXHJcbiAgICAgIH0sXHJcbiBcclxuICAgIH0sXHJcblxyXG4gICAgXHJcbiAgICBvbkxvYWQoKVxyXG4gICAge1xyXG4gICAgICB0aGlzLnRpbWVub2RlID0gY2MuZmluZChcIueVq+W4gy/np5LmlbjomZXnkIYv56eS5pW4XCIpO1xyXG4gICAgICB0aGlzLnRlbnNlY3NvdW5kID0gY2MuZmluZChcIueVq+W4g1wiKS5nZXRDb21wb25lbnQoVGltZUNvdW50X2pzKVxyXG4gICAgICBnYW1lTW9kZWwuWE1MVGltZUxpbWl0ID0gdHJ1ZVxyXG4gICAgICBnYW1lTW9kZWwuZ2FtZXRpbWVsaW1pdCA9IDEyXHJcbiAgICAgIGdhbWVNb2RlbC5nYW1ldGltZUNvdW50RG93biA9IDEyXHJcbiAgICAgIHRoaXMubGVycCA9IDEuMSAvIGdhbWVNb2RlbC5nYW1ldGltZWxpbWl0ICogMC4wMztcclxuICAgICAgdGhpcy5jb3VudCA9IDBcclxuICAgICAgdGhpcy5jID0gMFxyXG4gICAgICB0aGlzLkFuc3dlciA9IDJcclxuICAgICAgdGhpcy5hbHJlYWR5cmVkID0gZmFsc2VcclxuICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLlRpbWVCYXJQcm9ncmVzcywgMC4wMyk7XHJcbiAgICB9LFxyXG4gICAgc3RhcnQgKCkge1xyXG4gICAgICAgIGdhbWVNb2RlbC5HYW1lU3RhdHVzTWVzc2FnZSA9IFwib3BlblwiXHJcblxyXG4gICAgICAgIHRoaXMuQ29sb3JTdHJpbmcgPSB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCdDb2xvclN0cmluZycpXHJcbiAgICAgICAgLy90aGlzLlF1ZXN0aW9uLnN0cmluZyA9IGdhbWVNb2RlbC5RdWVzdGlvbltnYW1lTW9kZWwuUXVlc3Rpb25Db3VudF1cclxuICAgICAgICAvL3RoaXMuV2ViU29ja2V0X051bWJlck9mTG90dGVyeV9Ib3N0KCk7XHJcbiAgICAgICAgdGhpcy5TZWVSZXN1bHQgPSBmYWxzZVxyXG4gICAgICAgIHRoaXMuUGVvcGxlQW5zd2VyZWQuc3RyaW5nID0gMTBcclxuICAgICAgICBnYW1lTW9kZWwuQW5zd2VyUmVzdWx0ID0gWzEwLDE1LDIwLDMwXVxyXG4gICAgICAgIGdhbWVNb2RlbC5wZW9wbGUgPSA3NVxyXG4gICAgICAgIHRoaXMuTm93UXVlc3Rpb25Db3VudC5zdHJpbmcgPSBnYW1lTW9kZWwuUXVlc3Rpb25Db3VudCArIFwiL1wiICsgZ2FtZU1vZGVsLlF1ZXN0aW9uLmxlbmd0aFxyXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCA0OyBpKyspXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvL3RoaXMuT3B0aW9uc1tpXS5nZXRDaGlsZEJ5TmFtZShcIumBuOmgheaWh+Wtl1wiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGdhbWVNb2RlbC5PcHRpb25zW2ldO1xyXG4gICAgICAgICAgICB0aGlzLk9wYWNpdHlBbmlfU3RhcnQodGhpcy5PcHRpb25zW2ldLmdldENoaWxkQnlOYW1lKFwi6YG46aCF5paH5a2XXCIpKVxyXG4gICAgICAgICAgICB0aGlzLk9wYWNpdHlBbmlfU3RhcnQodGhpcy5PcHRpb25zW2ldLmdldENoaWxkQnlOYW1lKFwi6YG46aCF5a2X5q+NXCIpKVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLiBTcGF3bk5ld1dpbm5lcigpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuQ29sb3JTdHJpbmcpXHJcbiAgICAgICAgY29uc29sZS5sb2coZ2FtZU1vZGVsKVxyXG4gICAgfSxcclxuXHJcbiAgICAgLy/liJflh7rlvpfkurrnjY7nianku7ZcclxuICAgICBTcGF3bk5ld1dpbm5lcigpe1xyXG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgNTsgaSsrKVxyXG4gICAgICB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuUmFua1tpXS5nZXRDaGlsZEJ5TmFtZShcIueOqeWutuWQjeWtkFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi55Sc55ScXCIvL2dhbWVNb2RlbC53aW5uZXJfbmFtZVtpXVxyXG4gICAgICAgIHRoaXMuUmFua1tpXS5nZXRDaGlsZEJ5TmFtZShcIueOqeWutuWIhuaVuFwiKS5nZXRDaGlsZEJ5TmFtZShcIuWIhuaVuFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwiMTIzXCIvL2dhbWVNb2RlbC53aW5uZXJfc2NvcmVbaV1cclxuICAgICAgICB0aGlzLlJhbmtbaV0uZ2V0Q2hpbGRCeU5hbWUoXCLnjqnlrrbogJfmmYJcIikuZ2V0Q2hpbGRCeU5hbWUoXCLogJfmmYJcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBcIjMyMVwiLy9nYW1lTW9kZWwud2lubmVyX3RpbWVbaV1cclxuICAgICAgICAvL+mBoOerr+i8ieWFpTog57ay5Z2A6L2J5ZyW54mHXHJcbi8qICAgICAgICAgY2MuYXNzZXRNYW5hZ2VyLmxvYWRSZW1vdGUoZ2FtZU1vZGVsLndpbm5lcl9waWN0dXJlW2ldLHtleHQgOicuanBnJ3x8Jy5wbmcnfSxmdW5jdGlvbihlcnIsdGV4dHVyZSlcclxuICAgICAgICB7IFxyXG4gICAgICAgICAgaWYoZXJyKSBjb25zb2xlLmxvZyhcIumMr+iqpFwiKVxyXG4gICAgICAgICAgZWxzZVxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgdmFyIHBpY3R1cmUgPSBuZXcgY2MuU3ByaXRlRnJhbWUodGV4dHVyZSk7IC8vdGV4dHVyZSDovYkgU3ByaXRlRnJhbWVcclxuICAgICAgICAgIHNlbGYuUmFua1tpXS5nZXRDaGlsZEJ5TmFtZShcIumgreebuOahhlwiKS5nZXRDaGlsZEJ5TmFtZShcIumBrue9qVwiKS5nZXRDaGlsZEJ5TmFtZShcIueOqeWutumgreWDj1wiKS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IHBpY3R1cmU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7ICovXHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLk9wYWNpdHlBbmksIDAuMik7XHJcbiAgICB9LFxyXG5cclxuICAgIE9wYWNpdHlBbmkoKXtcclxuICAgICAgdGhpcy5QbGF5RGFya0FuaSh0aGlzLlJhbmtbdGhpcy5jXS5nZXRDaGlsZEJ5TmFtZShcIum7keW4g1wiKSlcclxuICAgICAgdGhpcy5jICsrXHJcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMuYylcclxuICAgICAgaWYgKHRoaXMuYyA9PSA1KSAgdGhpcy51bnNjaGVkdWxlKHRoaXMuT3BhY2l0eUFuaSk7XHJcbiAgICB9LFxyXG5cclxuICAgIEFuc3dlckJ1dHRvbigpe1xyXG4gICAgICAgIGlmKCB0aGlzLlNlZVJlc3VsdCA9PSBmYWxzZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgIC8vZ2FtZU1vZGVsLldlYlNvY2tldF9HYW1lU3RhdHVzX0hvc3QoXCJlbmRcIiwwLjEpXHJcbiAgICAgICAgIGdhbWVNb2RlbC5HYW1lU3RhdHVzTWVzc2FnZSA9IFwiZW5kXCJcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSAgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvL2dhbWVNb2RlbC5XZWJTb2NrZXRfR2FtZVN0YXR1c19Ib3N0KFwiZmluYWxcIiwwLjEpXHJcbiAgICAgICAgICAgIGlmKGdhbWVNb2RlbC5RdWVzdGlvbkNvdW50ID09IGdhbWVNb2RlbC5RdWVzdGlvbi5sZW5ndGgpIGNjLmRpcmVjdG9yLmxvYWRTY2VuZShcIkhvc3QzX0xhc3RcIik7XHJcbiAgICAgICAgICAgIGVsc2UgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgIC8vIGdhbWVNb2RlbC5XZWJTb2NrZXRfR2FtZVN0YXR1c19Ib3N0KFwibmV4dFwiLDAuMSlcclxuICAgICAgICAgICAgICAgIGdhbWVNb2RlbC5RdWVzdGlvbkNvdW50ICsrXHJcbiAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5sb2FkU2NlbmUoXCJIb3N0MV9RdWVzdGlvblwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBQcmludFJlc3VsdCgpe1xyXG4gICAgICAgdGhpcy5TZWVSZXN1bHQgPSB0cnVlO1xyXG4gICAgICAgdGhpcy50aW1lbm9kZS5hY3RpdmUgPSBmYWxzZVxyXG4gICAgICAgdGhpcy5TaG93QW5zd2VyU3RyaW5nLnN0cmluZyA9IGdhbWVNb2RlbC5RdWVzdGlvbkNvdW50ID09IGdhbWVNb2RlbC5RdWVzdGlvbi5sZW5ndGg/IFwi57WQ566XXCIgOiBcIuS4i+S4gOmhjFwiXHJcbiAgICAgICB0aGlzLlRpbWVCYXIuZmlsbFJhbmdlID0gMFxyXG4gICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLlByb2dyZXNzQmFyLCAwLjAxKTtcclxuICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCA0OyBpKyspXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLlJlc3VsdEFuc3dlcmVkW2ldLmFjdGl2ZSA9IHRydWVcclxuICAgICAgICAgICAgdGhpcy5SZXN1bHRBbnN3ZXJlZFtpXS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IGdhbWVNb2RlbC5BbnN3ZXJSZXN1bHRbaV0gKyBcIuS6ulwiO1xyXG4gICAgICAgICAgICAvL3RoaXMuUmVzdWx0W2ldLmZpbGxSYW5nZSA9IC1nYW1lTW9kZWwuQW5zd2VyUmVzdWx0W2ldIC8gZ2FtZU1vZGVsLnBlb3BsZSA7XHJcbiAgICAgICAgICAgIHRoaXMuaSA9IDBcclxuICAgICAgICAgICAgaWYoaSA9PSB0aGlzLkFuc3dlcikgY29udGludWU7XHJcbiAgICAgICAgICAgIHRoaXMuT3B0aW9uc1tpXS5jb2xvciA9IHRoaXMuT3B0aW9uc1tpXS5nZXRDaGlsZEJ5TmFtZShcIumBuOmgheaWh+Wtl1wiKS5jb2xvciA9IHRoaXMuT3B0aW9uc1tpXS5nZXRDaGlsZEJ5TmFtZShcIumBuOmgheWtl+avjVwiKS5jb2xvciA9IHRoaXMuQ29sb3JTdHJpbmcuY29sb3JPZlN0cmluZygnIzA0NTg1OCcpICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IDU7IGkrKylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuUGxheUJyaWdodEFuaSh0aGlzLlJhbmtbaV0uZ2V0Q2hpbGRCeU5hbWUoXCLpu5HluINcIikpXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBQbGF5QnJpZ2h0QW5pKG5vZGUpe1xyXG4gICAgICAgY2MudHdlZW4obm9kZSlcclxuICAgICAgLnRvKDIsIHtvcGFjaXR5OiAyNTV9KVxyXG4gICAgICAuc3RhcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgUGxheURhcmtBbmkobm9kZSl7XHJcbiAgICAgIGNjLnR3ZWVuKG5vZGUpXHJcbiAgICAgIC50bygyLCB7b3BhY2l0eTogMH0pXHJcbiAgICAgIC5zdGFydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBPcGFjaXR5QW5pX1N0YXJ0KG5vZGUpe1xyXG4gICAgICBub2RlLm9wYWNpdHkgPSAwXHJcbiAgICAgIGNjLnR3ZWVuKG5vZGUpXHJcbiAgICAgIC50bygwLjMsIHtvcGFjaXR5OiAyNTV9KVxyXG4gICAgICAuc3RhcnQoKTtcclxuICAgIH0sXHJcblxyXG4gICAgT3BhY2l0eUFuaV9UaW1lKCl7XHJcbiAgICAgIGNjLnR3ZWVuKHRoaXMuVGltZWxpZ2h0Lm5vZGUpXHJcbiAgICAgIC5yZXBlYXRGb3JldmVyKGNjLnR3ZWVuKClcclxuICAgICAgLnRvKDAuMiwgeyBvcGFjaXR5OiAwfSlcclxuICAgICAgLnRvKDAuMiwgeyBvcGFjaXR5OiAyNTV9KVxyXG4gICAgICApXHJcbiAgICAgIC5zdGFydCgpXHJcbiAgICB9LFxyXG5cclxuICAgIFByb2dyZXNzQmFyKCl7XHJcbiAgICAgIHRoaXMuUmVzdWx0W3RoaXMuaV0uZmlsbFJhbmdlIC09IDAuMDE7XHJcbiAgICAgIGlmICh0aGlzLlJlc3VsdFt0aGlzLmldLmZpbGxSYW5nZSA8PSAtZ2FtZU1vZGVsLkFuc3dlclJlc3VsdFt0aGlzLmldIC8gZ2FtZU1vZGVsLnBlb3BsZSlcclxuICAgICAge1xyXG4gICAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMuUHJvZ3Jlc3NCYXIpO1xyXG4gICAgICAgICAgdGhpcy5pICsrIFxyXG4gICAgICAgICAgaWYodGhpcy5pID4gMykgcmV0dXJuO1xyXG4gICAgICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLlByb2dyZXNzQmFyLCAwLjAxKTtcclxuICAgICAgfSBcclxuICAgIH0sXHJcblxyXG4gICAgVGltZUJhclByb2dyZXNzKCl7XHJcbiAgICAgIHRoaXMuVGltZUJhci5maWxsUmFuZ2UgLT0gdGhpcy5sZXJwO1xyXG4gICAgICB0aGlzLmNvdW50ICsrIFxyXG4gICAgICBpZihnYW1lTW9kZWwuZ2FtZXRpbWVDb3VudERvd24gPT0gMTAgJiYgdGhpcy5hbHJlYWR5cmVkID09IGZhbHNlKSBcclxuICAgICAge1xyXG4gICAgICAgIHRoaXMuYWxyZWFkeXJlZCA9IHRydWVcclxuICAgICAgICB0aGlzLlRpbWVCYXIuc3ByaXRlRnJhbWUgPSB0aGlzLlJlZFRpbWVCYXJcclxuICAgICAgICB0aGlzLlRpbWVsaWdodC5zcHJpdGVGcmFtZSA9IHRoaXMuUmVkVGltZWxpZ2h0ICBcclxuICAgICAgICB0aGlzLk9wYWNpdHlBbmlfVGltZSgpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0aGlzLlRpbWVCYXIuZmlsbFJhbmdlIDwgMClcclxuICAgICAge1xyXG4gICAgICAgIHRoaXMuVGltZWxpZ2h0Lm5vZGUuYWN0aXZlID0gZmFsc2VcclxuICAgICAgICB0aGlzLnVuc2NoZWR1bGUodGhpcy5UaW1lQmFyUHJvZ3Jlc3MpO1xyXG4gICAgICB9IFxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGUgKGR0KSB7XHJcbiAgICAgICAgaWYoZ2FtZU1vZGVsLkdhbWVTdGF0dXNNZXNzYWdlID09IFwiZW5kXCIgJiYgdGhpcy5TZWVSZXN1bHQgPT0gZmFsc2UpIFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGNjLmF1ZGlvRW5naW5lLnN0b3AodGhpcy50ZW5zZWNzb3VuZC5jdXJyZW50c291bmQpXHJcbiAgICAgICAgICB0aGlzLlByaW50UmVzdWx0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==